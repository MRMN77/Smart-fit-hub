<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <!-- استایل اصلی -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پروفایل کاربر - Smart Fit Hub</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4a6fa5;
            --primary-dark: #166088;
            --secondary: #4fc3a1;
            --accent: #ff6b6b;
            --light: #f8f9fa;
            --dark: #343a40;
            --gold: #ffd700;
            --silver: #c0c0c0;
            --bronze: #cd7f32;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.8;
            overflow-x: hidden;
        }

        /* هدر */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 1rem 5%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: white;
        }

        .logo-img {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--secondary), #2a9d8f);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            color: white;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
            line-height: 1.2;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .btn {
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            border: none;
        }

        .btn-outline {
            background-color: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-outline:hover {
            background-color: white;
            color: var(--primary);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), #2a9d8f);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(79, 195, 161, 0.3);
        }

        /* پروفایل */
        .profile-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .profile-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 3rem 2rem;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: white;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: var(--primary);
            border: 5px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .avatar-upload {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            padding: 0.5rem;
            text-align: center;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .profile-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        .profile-sidebar {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
        }

        .sidebar-menu li {
            margin-bottom: 0.5rem;
        }

        .sidebar-menu a {
            color: #333;
            text-decoration: none;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: var(--light);
            color: var(--primary);
        }

        .profile-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .form-section {
            margin-bottom: 3rem;
        }

        .form-section h3 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
        }

        /* بخش‌های جدید */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .chart-box {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-box h4 {
            color: var(--primary);
            margin-bottom: 1rem;
            text-align: center;
        }

        .subscription-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .subscription-card {
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid #ddd;
            position: relative;
        }

        .subscription-card.basic {
            border-color: var(--bronze);
        }

        .subscription-card.premium {
            border-color: var(--silver);
        }

        .subscription-card.vip {
            border-color: var(--gold);
        }

        .subscription-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .subscription-card h4 {
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .subscription-price {
            font-size: 2rem;
            font-weight: bold;
            margin: 1rem 0;
        }

        .subscription-features {
            list-style: none;
            padding: 0;
            text-align: right;
            margin-bottom: 1.5rem;
        }

        .subscription-features li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .subscription-features li i {
            color: var(--secondary);
            margin-left: 0.5rem;
        }

        .current-subscription {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--secondary);
            color: white;
            padding: 0.25rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .classes-section {
            margin-top: 3rem;
        }

        .classes-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 0.5rem;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 0.5rem 1.5rem;
            cursor: pointer;
            color: #666;
            font-weight: 600;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
        }

        .tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }

        .classes-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }

        .class-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            border: 1px solid #eee;
            transition: all 0.3s;
        }

        .class-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .class-time {
            background: var(--light);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .chat-section {
            margin-top: 3rem;
            background: var(--light);
            border-radius: 12px;
            padding: 2rem;
        }

        .chat-container {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border-radius: 8px;
            max-width: 80%;
        }

        .message.sent {
            background: #e3f2fd;
            margin-left: auto;
        }

        .message.received {
            background: #f5f5f5;
            margin-right: auto;
        }

        .chat-input {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        .payment-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .payment-summary {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .payment-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid #eee;
        }

        .payment-total {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-top: 1rem;
        }

        .coach-earnings {
            background: linear-gradient(135deg, var(--secondary), #2a9d8f);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .profile-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .charts-container {
                grid-template-columns: 1fr;
            }

            .subscription-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- هدر -->
    <header>
        <nav class="navbar">
            <a href="index.html" class="logo">
                <div class="logo-img">SFH</div>
                <div class="logo-text">
                    <h1>Smart Fit Hub</h1>
                    <span>پلتفرم جامع مدیریت باشگاه</span>
                </div>
            </a>

            <div class="user-menu">
                <div class="user-info">
                    <div class="user-avatar" onclick="location.href='profile.html'">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <div id="userName">کاربر عزیز</div>
                        <small id="userRole">ورزشکار</small>
                    </div>
                </div>
                <a href="dashboard.html" class="btn btn-outline">
                    <i class="fas fa-home"></i> داشبورد
                </a>
                <button class="btn btn-outline" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> خروج
                </button>
            </div>
        </nav>
    </header>

    <!-- پروفایل -->
    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-avatar">
                <i class="fas fa-user" id="avatarIcon"></i>
                <div class="avatar-upload" onclick="uploadAvatar()">
                    <i class="fas fa-camera"></i> تغییر عکس
                </div>
            </div>
            <h1 id="profileName">کاربر عزیز</h1>
            <p id="profileRole">عضویت از: <span id="joinDate">۱۴۰۲/۰۱/۱۵</span></p>
            <span id="fitnessLevelBadge" class="badge bg-warning">سطح متوسط</span>
            <span id="subscriptionBadge" class="badge bg-success ms-2">پریمیوم</span>
        </div>

        <div class="profile-grid">
            <!-- سایدبار -->
            <aside class="profile-sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#personal" class="active" onclick="showSection('personal')"><i class="fas fa-user-circle"></i> اطلاعات شخصی</a></li>
                    <li><a href="#fitness" onclick="showSection('fitness')"><i class="fas fa-dumbbell"></i> اطلاعات ورزشی</a></li>
                    <li><a href="#health" onclick="showSection('health')"><i class="fas fa-heartbeat"></i> اطلاعات سلامتی</a></li>
                    <li><a href="#charts" onclick="showSection('charts')"><i class="fas fa-chart-line"></i> نمودارها</a></li>
                    <li><a href="#subscription" onclick="showSection('subscription')"><i class="fas fa-crown"></i> اشتراک و پرداخت</a></li>
                    <li><a href="#classes" onclick="showSection('classes')"><i class="fas fa-calendar-alt"></i> کلاس‌ها</a></li>
                    <li><a href="#chat" onclick="showSection('chat')"><i class="fas fa-comments"></i> چت با مربی</a></li>
                    <li><a href="#security" onclick="showSection('security')"><i class="fas fa-shield-alt"></i> امنیت</a></li>
                    <li><a href="dashboard.html"><i class="fas fa-arrow-right"></i> بازگشت به داشبورد</a></li>
                </ul>
            </aside>

            <!-- محتوای اصلی -->
            <main class="profile-content">
                <!-- بخش اطلاعات شخصی -->
                <div id="personal" class="form-section">
                    <h3><i class="fas fa-user-circle"></i> اطلاعات شخصی</h3>
                    <form id="personalForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">نام</label>
                                <input type="text" class="form-control" id="firstName" value="محمد">
                            </div>
                            <div class="form-group">
                                <label class="form-label">نام خانوادگی</label>
                                <input type="text" class="form-control" id="lastName" value="رضایی">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ایمیل</label>
                                <input type="email" class="form-control" id="profileEmail" value="mohammad@example.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">شماره موبایل</label>
                                <input type="tel" class="form-control" id="profilePhone" value="09123456789">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">کد ملی</label>
                                <input type="text" class="form-control" id="nationalCode" value="0012345678">
                            </div>
                            <div class="form-group">
                                <label class="form-label">تاریخ تولد</label>
                                <input type="text" class="form-control" id="profileBirthDate" value="1370/01/01">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">جنسیت</label>
                                <select class="form-control" id="profileGender">
                                    <option value="male" selected>مرد</option>
                                    <option value="female">زن</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">نقش</label>
                                <select class="form-control" id="userRoleSelect" onchange="changeUserRole()">
                                    <option value="athlete" selected>ورزشکار</option>
                                    <option value="coach">مربی</option>
                                    <option value="admin">مدیر</option>
                                </select>
                            </div>
                        </div>

                        <button type="button" class="btn btn-primary" onclick="savePersonalInfo()">
                            <i class="fas fa-save"></i> ذخیره تغییرات
                        </button>
                    </form>
                </div>

                <!-- بخش اطلاعات ورزشی -->
                <div id="fitness" class="form-section" style="display: none;">
                    <h3><i class="fas fa-dumbbell"></i> اطلاعات ورزشی</h3>
                    <form id="fitnessForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">سطح ورزشی</label>
                                <select class="form-control" id="fitnessLevel">
                                    <option value="beginner">مبتدی</option>
                                    <option value="intermediate" selected>متوسط</option>
                                    <option value="advanced">پیشرفته</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">هدف ورزشی</label>
                                <select class="form-control" id="fitnessGoal">
                                    <option value="weight_loss">کاهش وزن</option>
                                    <option value="muscle_gain" selected>افزایش عضله</option>
                                    <option value="endurance">افزایش استقامت</option>
                                    <option value="health">سلامت عمومی</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">تعداد جلسات در هفته</label>
                                <input type="number" class="form-control" id="weeklySessions" value="3" min="1" max="7">
                            </div>
                            <div class="form-group">
                                <label class="form-label">مدت هر جلسه (دقیقه)</label>
                                <input type="number" class="form-control" id="sessionDuration" value="60" min="15" max="180">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">باشگاه</label>
                            <select class="form-control" id="gymSelect">
                                <option value="gym1" selected>باشگاه مرکزی</option>
                                <option value="gym2">باشگاه غرب</option>
                                <option value="gym3">باشگاه شرق</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">مربی اختصاصی</label>
                            <select class="form-control" id="coachSelect">
                                <option value="coach1" selected>علی محمدی</option>
                                <option value="coach2">فاطمه کریمی</option>
                                <option value="coach3">رضا احمدی</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">علاقه‌مندی‌های ورزشی</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                <label style="display: flex; align-items: center; gap: 0.25rem;">
                                    <input type="checkbox" name="interests" value="bodybuilding" checked> بدنسازی
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem;">
                                    <input type="checkbox" name="interests" value="cardio"> کاردیو
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem;">
                                    <input type="checkbox" name="interests" value="yoga"> یوگا
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem;">
                                    <input type="checkbox" name="interests" value="crossfit"> کراس فیت
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem;">
                                    <input type="checkbox" name="interests" value="swimming"> شنا
                                </label>
                            </div>
                        </div>

                        <button type="button" class="btn btn-primary" onclick="saveFitnessInfo()">
                            <i class="fas fa-save"></i> ذخیره اطلاعات ورزشی
                        </button>
                    </form>
                </div>

                <!-- بخش اطلاعات سلامتی -->
                <div id="health" class="form-section" style="display: none;">
                    <h3><i class="fas fa-heartbeat"></i> اطلاعات سلامتی</h3>
                    <form id="healthForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">قد (سانتی‌متر)</label>
                                <input type="number" class="form-control" id="height" value="175" min="100" max="250">
                            </div>
                            <div class="form-group">
                                <label class="form-label">وزن (کیلوگرم)</label>
                                <input type="number" class="form-control" id="weight" value="75" min="30" max="200" step="0.1">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">BMI</label>
                            <div class="form-control" id="bmiValue" style="background-color: #f8f9fa;">24.5 (طبیعی)</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">بیماری‌ها یا شرایط خاص</label>
                            <textarea class="form-control" id="medicalConditions" rows="3" placeholder="در صورت وجود بیماری خاص، ذکر کنید"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">داروهای مصرفی</label>
                            <textarea class="form-control" id="medications" rows="3" placeholder="داروهای مصرفی خود را ذکر کنید"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">آلرژی‌ها</label>
                            <textarea class="form-control" id="allergies" rows="3" placeholder="آلرژی‌های خود را ذکر کنید"></textarea>
                        </div>

                        <button type="button" class="btn btn-primary" onclick="saveHealthInfo()">
                            <i class="fas fa-save"></i> ذخیره اطلاعات سلامتی
                        </button>
                    </form>
                </div>

                <!-- بخش نمودارها -->
                <div id="charts" class="form-section" style="display: none;">
                    <h3><i class="fas fa-chart-line"></i> نمودارهای ورزشی</h3>

                    <div class="charts-container">
                        <div class="chart-box">
                            <h4>پیشرفت ورزشی هفتگی</h4>
                            <canvas id="progressChart"></canvas>
                        </div>

                        <div class="chart-box">
                            <h4>ساعات ورزش در ماه</h4>
                            <canvas id="hoursChart"></canvas>
                        </div>

                        <div class="chart-box">
                            <h4>توزیع فعالیت‌ها</h4>
                            <canvas id="activitiesChart"></canvas>
                        </div>

                        <div class="chart-box">
                            <h4>تعداد کالری سوزانده شده</h4>
                            <canvas id="caloriesChart"></canvas>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="chart-box">
                                <h4>ضربان قلب</h4>
                                <canvas id="heartRateChart"></canvas>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="chart-box">
                                <h4>تحلیل خواب</h4>
                                <canvas id="sleepChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- بخش اشتراک و پرداخت -->
                <div id="subscription" class="form-section" style="display: none;">
                    <h3><i class="fas fa-crown"></i> اشتراک و پرداخت</h3>

                    <div class="subscription-cards">
                        <div class="subscription-card basic">
                            <h4>اشتراک پایه</h4>
                            <div class="subscription-price">150,000 تومان</div>
                            <ul class="subscription-features">
                                <li><i class="fas fa-check"></i> ۸ جلسه در ماه</li>
                                <li><i class="fas fa-check"></i> دسترسی به باشگاه</li>
                                <li><i class="fas fa-times text-muted"></i> مربی اختصاصی</li>
                                <li><i class="fas fa-times text-muted"></i> برنامه غذایی</li>
                                <li><i class="fas fa-times text-muted"></i> مشاوره تخصصی</li>
                            </ul>
                            <button class="btn btn-primary w-100" onclick="selectSubscription('basic')">انتخاب</button>
                        </div>

                        <div class="subscription-card premium">
                            <div class="current-subscription">فعلی</div>
                            <h4>اشتراک پریمیوم</h4>
                            <div class="subscription-price">350,000 تومان</div>
                            <ul class="subscription-features">
                                <li><i class="fas fa-check"></i> ۱۶ جلسه در ماه</li>
                                <li><i class="fas fa-check"></i> دسترسی به باشگاه</li>
                                <li><i class="fas fa-check"></i> مربی اختصاصی</li>
                                <li><i class="fas fa-check"></i> برنامه غذایی</li>
                                <li><i class="fas fa-times text-muted"></i> مشاوره تخصصی</li>
                            </ul>
                            <button class="btn btn-primary w-100" onclick="selectSubscription('premium')">انتخاب</button>
                        </div>

                        <div class="subscription-card vip">
                            <h4>اشتراک VIP</h4>
                            <div class="subscription-price">600,000 تومان</div>
                            <ul class="subscription-features">
                                <li><i class="fas fa-check"></i> جلسات نامحدود</li>
                                <li><i class="fas fa-check"></i> دسترسی به باشگاه</li>
                                <li><i class="fas fa-check"></i> مربی اختصاصی</li>
                                <li><i class="fas fa-check"></i> برنامه غذایی</li>
                                <li><i class="fas fa-check"></i> مشاوره تخصصی</li>
                            </ul>
                            <button class="btn btn-primary w-100" onclick="selectSubscription('vip')">انتخاب</button>
                        </div>
                    </div>

                    <!-- بخش پرداخت -->
                    <div class="payment-section">
                        <h4><i class="fas fa-credit-card"></i> اطلاعات پرداخت</h4>

                        <div class="payment-summary">
                            <div class="payment-item">
                                <span>اشتراک فعلی:</span>
                                <span id="currentSubPrice">350,000 تومان</span>
                            </div>
                            <div class="payment-item">
                                <span>مدت باقی‌مانده:</span>
                                <span id="remainingDays">۱۵ روز</span>
                            </div>
                            <div class="payment-item">
                                <span>کل پرداختی‌ها:</span>
                                <span id="totalPayments">2,450,000 تومان</span>
                            </div>
                            <div class="payment-item">
                                <span>آخرین پرداخت:</span>
                                <span id="lastPayment">۱۴۰۲/۱۱/۱۵</span>
                            </div>
                            <div class="payment-total">
                                <span>موجودی کیف پول:</span>
                                <span id="walletBalance">150,000 تومان</span>
                            </div>
                        </div>

                        <div class="mt-3">
                            <button class="btn btn-primary" onclick="showPaymentModal()">
                                <i class="fas fa-plus"></i> افزایش موجودی
                            </button>
                            <button class="btn btn-outline-primary ms-2" onclick="showPaymentHistory()">
                                <i class="fas fa-history"></i> تاریخچه پرداخت
                            </button>
                        </div>
                    </div>

                    <!-- برای مربیان -->
                    <div id="coachEarnings" class="coach-earnings" style="display: none;">
                        <h4><i class="fas fa-money-bill-wave"></i> درآمد ماهانه</h4>
                        <div class="row text-center mt-3">
                            <div class="col-md-4">
                                <h5>کل درآمد</h5>
                                <h3 id="totalEarnings">12,500,000 تومان</h3>
                            </div>
                            <div class="col-md-4">
                                <h5>تعداد شاگردان</h5>
                                <h3 id="totalStudents">۲۴ نفر</h3>
                            </div>
                            <div class="col-md-4">
                                <h5>میانگین درآمد</h5>
                                <h3 id="avgEarnings">520,000 تومان</h3>
                            </div>
                        </div>
                        <button class="btn btn-light mt-3" onclick="showEarningsDetails()">
                            <i class="fas fa-chart-pie"></i> مشاهده جزئیات درآمد
                        </button>
                    </div>
                </div>

                <!-- بخش کلاس‌ها -->
                <div id="classes" class="form-section" style="display: none;">
                    <h3><i class="fas fa-calendar-alt"></i> کلاس‌های من</h3>

                    <div class="classes-tabs">
                        <button class="tab-btn active" onclick="showClassesTab('current')">این هفته</button>
                        <button class="tab-btn" onclick="showClassesTab('next')">هفته آینده</button>
                        <button class="tab-btn" onclick="showClassesTab('past')">گذشته</button>
                    </div>

                    <div id="currentClasses" class="classes-list">
                        <!-- کلاس‌های این هفته -->
                        <div class="class-card">
                            <div class="class-header">
                                <h5>بدنسازی پیشرفته</h5>
                                <span class="class-time">۱۷:۰۰ - ۱۸:۳۰</span>
                            </div>
                            <p><i class="fas fa-user-tie"></i> مربی: علی محمدی</p>
                            <p><i class="fas fa-building"></i> باشگاه: مرکزی</p>
                            <p><i class="fas fa-calendar"></i> تاریخ: ۱۴۰۲/۱۲/۰۵</p>
                            <button class="btn btn-primary btn-sm mt-2" onclick="joinClass(this)">
                                <i class="fas fa-video"></i> ورود به کلاس
                            </button>
                        </div>

                        <div class="class-card">
                            <div class="class-header">
                                <h5>یوگا</h5>
                                <span class="class-time">۰۸:۰۰ - ۰۹:۰۰</span>
                            </div>
                            <p><i class="fas fa-user-tie"></i> مربی: فاطمه کریمی</p>
                            <p><i class="fas fa-building"></i> باشگاه: غرب</p>
                            <p><i class="fas fa-calendar"></i> تاریخ: ۱۴۰۲/۱۲/۰۷</p>
                            <button class="btn btn-primary btn-sm mt-2" onclick="joinClass(this)">
                                <i class="fas fa-video"></i> ورود به کلاس
                            </button>
                        </div>
                    </div>

                    <div id="nextClasses" class="classes-list" style="display: none;">
                        <!-- کلاس‌های هفته آینده -->
                        <div class="class-card">
                            <div class="class-header">
                                <h5>کراس فیت</h5>
                                <span class="class-time">۱۰:۰۰ - ۱۱:۳۰</span>
                            </div>
                            <p><i class="fas fa-user-tie"></i> مربی: رضا احمدی</p>
                            <p><i class="fas fa-building"></i> باشگاه: شرق</p>
                            <p><i class="fas fa-calendar"></i> تاریخ: ۱۴۰۲/۱۲/۱۲</p>
                            <button class="btn btn-outline-primary btn-sm mt-2" onclick="cancelClass(this)">
                                <i class="fas fa-times"></i> کنسل کردن
                            </button>
                        </div>
                    </div>

                    <div id="pastClasses" class="classes-list" style="display: none;">
                        <!-- کلاس‌های گذشته -->
                        <div class="class-card">
                            <div class="class-header">
                                <h5>کاردیو</h5>
                                <span class="class-time">۱۹:۰۰ - ۲۰:۰۰</span>
                            </div>
                            <p><i class="fas fa-user-tie"></i> مربی: علی محمدی</p>
                            <p><i class="fas fa-building"></i> باشگاه: مرکزی</p>
                            <p><i class="fas fa-calendar"></i> تاریخ: ۱۴۰۲/۱۲/۰۱</p>
                            <span class="badge bg-success">شرکت کرده‌اید</span>
                        </div>
                    </div>
                </div>

                <!-- بخش چت -->
                <div id="chat" class="form-section" style="display: none;">
                    <h3><i class="fas fa-comments"></i> چت با مربی</h3>

                    <div class="chat-section">
                        <div class="mb-3">
                            <label class="form-label">انتخاب مربی برای چت</label>
                            <select class="form-control" id="selectCoachChat" onchange="loadChatHistory()">
                                <option value="coach1">علی محمدی</option>
                                <option value="coach2">فاطمه کریمی</option>
                                <option value="coach3">رضا احمدی</option>
                            </select>
                        </div>

                        <div class="chat-container">
                            <div class="chat-messages" id="chatMessages">
                                <div class="message received">
                                    <strong>علی محمدی:</strong>
                                    <p>سلام محمد جان! تمرین امروز چطور بود؟</p>
                                    <small>امروز ۱۴:۳۰</small>
                                </div>
                                <div class="message sent">
                                    <strong>شما:</strong>
                                    <p>سلام استاد! عالی بود. اما در حرکت اسکات کمی درد زانو داشتم.</p>
                                    <small>امروز ۱۴:۳۵</small>
                                </div>
                                <div class="message received">
                                    <strong>علی محمدی:</strong>
                                    <p>حتماً فرم حرکت رو چک کن. فردا با هم بررسی می‌کنیم.</p>
                                    <small>امروز ۱۴:۴۰</small>
                                </div>
                            </div>

                            <div class="chat-input">
                                <input type="text" id="messageInput" placeholder="پیام خود را بنویسید..." onkeypress="handleKeyPress(event)">
                                <button class="btn btn-primary" onclick="sendMessage()">
                                    <i class="fas fa-paper-plane"></i> ارسال
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- بخش امنیت -->
                <div id="security" class="form-section" style="display: none;">
                    <h3><i class="fas fa-shield-alt"></i> امنیت حساب کاربری</h3>
                    <form id="securityForm">
                        <div class="form-group">
                            <label class="form-label">رمز عبور فعلی</label>
                            <input type="password" class="form-control" id="currentPassword" placeholder="رمز عبور فعلی">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">رمز عبور جدید</label>
                                <input type="password" class="form-control" id="newPassword" placeholder="رمز عبور جدید">
                            </div>
                            <div class="form-group">
                                <label class="form-label">تکرار رمز عبور جدید</label>
                                <input type="password" class="form-control" id="confirmNewPassword" placeholder="تکرار رمز عبور جدید">
                            </div>
                        </div>

                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="twoFactor">
                                فعال‌سازی احراز هویت دو مرحله‌ای
                            </label>
                        </div>

                        <button type="button" class="btn btn-primary" onclick="changePassword()">
                            <i class="fas fa-key"></i> تغییر رمز عبور
                        </button>

                        <hr class="my-4">

                        <h5><i class="fas fa-history"></i> فعالیت‌های اخیر حساب</h5>
                        <div class="mt-3">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i> آخرین ورود: امروز ۱۴:۲۵ از IP: 192.168.1.1
                            </div>
                            <div class="alert alert-light">
                                <i class="fas fa-laptop"></i> تغییر اطلاعات شخصی: دیروز ۱۶:۴۰
                            </div>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <!-- مودال پرداخت -->
    <div class="modal fade" id="paymentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">افزایش موجودی کیف پول</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">مبلغ (تومان)</label>
                        <input type="number" class="form-control" id="paymentAmount" placeholder="مبلغ را وارد کنید">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">درگاه پرداخت</label>
                        <select class="form-control" id="paymentGateway">
                            <option value="zarinpal">زرین‌پال</option>
                            <option value="mellat">ملت</option>
                            <option value="saman">سامان</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">انصراف</button>
                    <button type="button" class="btn btn-primary" onclick="processPayment()">پرداخت</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // بررسی وضعیت لاگین
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const userName = localStorage.getItem('userName') || 'کاربر عزیز';
            const userRole = localStorage.getItem('userRole') || 'athlete';

            if (isLoggedIn !== 'true') {
                alert('لطفاً ابتدا وارد شوید');
                window.location.href = 'login.html';
                return false;
            }

            // نمایش نام کاربر و نقش
            document.getElementById('userName').textContent = userName;
            document.getElementById('profileName').textContent = userName;
            document.getElementById('userRole').textContent = getRoleName(userRole);
            document.getElementById('profileRole').textContent = getRoleName(userRole);
            document.getElementById('userRoleSelect').value = userRole;

            // بارگذاری اطلاعات کاربر از localStorage
            loadUserProfile();

            return true;
        }

        // دریافت نام نقش
        function getRoleName(role) {
            const roles = {
                'athlete': 'ورزشکار',
                'coach': 'مربی',
                'admin': 'مدیر'
            };
            return roles[role] || 'کاربر';
        }

        // بارگذاری پروفایل کاربر
        function loadUserProfile() {
            // بارگذاری اطلاعات از localStorage
            const savedEmail = localStorage.getItem('userEmail');
            const savedPhone = localStorage.getItem('userPhone');
            const userRole = localStorage.getItem('userRole') || 'athlete';

            if (savedEmail) {
                document.getElementById('profileEmail').value = savedEmail;
            }

            if (savedPhone) {
                document.getElementById('profilePhone').value = savedPhone;
            }

            // نمایش یا مخفی کردن بخش‌های مربوط به مربیان
            if (userRole === 'coach') {
                document.getElementById('coachEarnings').style.display = 'block';
            }

            // ایجاد نمودارها
            createCharts();
        }

        // تغییر نقش کاربر
        function changeUserRole() {
            const role = document.getElementById('userRoleSelect').value;
            localStorage.setItem('userRole', role);
            document.getElementById('userRole').textContent = getRoleName(role);
            document.getElementById('profileRole').textContent = getRoleName(role);

            if (role === 'coach') {
                document.getElementById('coachEarnings').style.display = 'block';
            } else {
                document.getElementById('coachEarnings').style.display = 'none';
            }

            alert('نقش کاربر با موفقیت تغییر یافت');
        }

        // ایجاد نمودارها
        function createCharts() {
            // نمودار پیشرفت ورزشی
            const progressCtx = document.getElementById('progressChart').getContext('2d');
            new Chart(progressCtx, {
                type: 'line',
                data: {
                    labels: ['هفته ۱', 'هفته ۲', 'هفته ۳', 'هفته ۴'],
                    datasets: [{
                        label: 'پیشرفت',
                        data: [65, 70, 75, 80],
                        borderColor: '#4a6fa5',
                        backgroundColor: 'rgba(74, 111, 165, 0.1)',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });

            // نمودار ساعات ورزش
            const hoursCtx = document.getElementById('hoursChart').getContext('2d');
            new Chart(hoursCtx, {
                type: 'bar',
                data: {
                    labels: ['فروردین', 'اردیبهشت', 'خرداد', 'تیر', 'مرداد', 'شهریور'],
                    datasets: [{
                        label: 'ساعات ورزش',
                        data: [12, 15, 18, 16, 20, 22],
                        backgroundColor: '#4fc3a1'
                    }]
                },
                options: {
                    responsive: true
                }
            });

            // نمودار فعالیت‌ها
            const activitiesCtx = document.getElementById('activitiesChart').getContext('2d');
            new Chart(activitiesCtx, {
                type: 'doughnut',
                data: {
                    labels: ['بدنسازی', 'کاردیو', 'یوگا', 'کراس فیت'],
                    datasets: [{
                        data: [40, 30, 20, 10],
                        backgroundColor: ['#4a6fa5', '#4fc3a1', '#ff6b6b', '#ffd700']
                    }]
                },
                options: {
                    responsive: true
                }
            });

            // نمودار کالری
            const caloriesCtx = document.getElementById('caloriesChart').getContext('2d');
            new Chart(caloriesCtx, {
                type: 'radar',
                data: {
                    labels: ['کاردیو', 'بدنسازی', 'انعطاف', 'استقامت', 'سرعت'],
                    datasets: [{
                        label: 'کالری سوزانده شده',
                        data: [85, 75, 60, 80, 70],
                        backgroundColor: 'rgba(255, 107, 107, 0.2)',
                        borderColor: '#ff6b6b'
                    }]
                },
                options: {
                    responsive: true
                }
            });

            // نمودار ضربان قلب
            const heartCtx = document.getElementById('heartRateChart').getContext('2d');
            new Chart(heartCtx, {
                type: 'line',
                data: {
                    labels: ['۸:۰۰', '۱۰:۰۰', '۱۲:۰۰', '۱۴:۰۰', '۱۶:۰۰', '۱۸:۰۰'],
                    datasets: [{
                        label: 'ضربان قلب',
                        data: [75, 85, 120, 110, 95, 80],
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)'
                    }]
                },
                options: {
                    responsive: true
                }
            });

            // نمودار خواب
            const sleepCtx = document.getElementById('sleepChart').getContext('2d');
            new Chart(sleepCtx, {
                type: 'bar',
                data: {
                    labels: ['شنبه', 'یکشنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنجشنبه', 'جمعه'],
                    datasets: [{
                        label: 'ساعت خواب',
                        data: [7, 6.5, 7.5, 8, 7, 8.5, 9],
                        backgroundColor: '#4a6fa5'
                    }]
                },
                options: {
                    responsive: true
                }
            });
        }

        // نمایش بخش‌های مختلف
        function showSection(sectionId) {
            // مخفی کردن همه بخش‌ها
            const sections = document.querySelectorAll('.form-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            // نمایش بخش انتخاب شده
            document.getElementById(sectionId).style.display = 'block';

            // بروزرسانی منوی فعال
            const menuItems = document.querySelectorAll('.sidebar-menu a');
            menuItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + sectionId) {
                    item.classList.add('active');
                }
            });

            // اگر بخش نمودارها نمایش داده شد، نمودارها را بروزرسانی کن
            if (sectionId === 'charts') {
                setTimeout(() => {
                    createCharts();
                }, 100);
            }
        }

        // نمایش تب‌های کلاس
        function showClassesTab(tab) {
            // مخفی کردن همه تب‌ها
            document.getElementById('currentClasses').style.display = 'none';
            document.getElementById('nextClasses').style.display = 'none';
            document.getElementById('pastClasses').style.display = 'none';

            // نمایش تب انتخاب شده
            document.getElementById(tab + 'Classes').style.display = 'grid';

            // بروزرسانی دکمه‌های فعال
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // آپلود عکس پروفایل
        function uploadAvatar() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';

            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const avatarIcon = document.getElementById('avatarIcon');
                        avatarIcon.parentElement.style.backgroundImage = `url(${e.target.result})`;
                        avatarIcon.parentElement.style.backgroundSize = 'cover';
                        avatarIcon.parentElement.style.backgroundPosition = 'center';
                        avatarIcon.style.display = 'none';

                        // ذخیره در localStorage
                        localStorage.setItem('userAvatar', e.target.result);

                        alert('عکس پروفایل با موفقیت تغییر یافت');
                    };
                    reader.readAsDataURL(file);
                }
            };

            input.click();
        }

        // بارگذاری عکس پروفایل از localStorage
        function loadAvatar() {
            const savedAvatar = localStorage.getItem('userAvatar');
            if (savedAvatar) {
                const avatarIcon = document.getElementById('avatarIcon');
                avatarIcon.parentElement.style.backgroundImage = `url(${savedAvatar})`;
                avatarIcon.parentElement.style.backgroundSize = 'cover';
                avatarIcon.parentElement.style.backgroundPosition = 'center';
                avatarIcon.style.display = 'none';
            }
        }

        // ذخیره اطلاعات شخصی
        function savePersonalInfo() {
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('profileEmail').value;
            const phone = document.getElementById('profilePhone').value;
            const nationalCode = document.getElementById('nationalCode').value;

            // اعتبارسنجی
            if (!firstName || !lastName || !email || !phone || !nationalCode) {
                alert('لطفاً تمام فیلدها را پر کنید');
                return;
            }

            // اعتبارسنجی شماره موبایل
            if (!phone.match(/^09[0-9]{9}$/)) {
                alert('شماره موبایل معتبر نیست');
                return;
            }

            // اعتبارسنجی کد ملی
            if (!nationalCode.match(/^[0-9]{10}$/)) {
                alert('کد ملی معتبر نیست');
                return;
            }

            // ذخیره در localStorage
            localStorage.setItem('userName', firstName + ' ' + lastName);
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userPhone', phone);
            localStorage.setItem('nationalCode', nationalCode);

            // به‌روزرسانی UI
            document.getElementById('userName').textContent = firstName + ' ' + lastName;
            document.getElementById('profileName').textContent = firstName + ' ' + lastName;

            alert('اطلاعات شخصی با موفقیت ذخیره شد');
        }

        // ذخیره اطلاعات ورزشی
        function saveFitnessInfo() {
            const fitnessLevel = document.getElementById('fitnessLevel').value;
            const fitnessGoal = document.getElementById('fitnessGoal').value;

            // به‌روزرسانی نشان‌گر سطح
            const levelNames = {
                'beginner': 'مبتدی',
                'intermediate': 'متوسط',
                'advanced': 'پیشرفته'
            };

            document.getElementById('fitnessLevelBadge').textContent = 'سطح ' + levelNames[fitnessLevel];
            document.getElementById('fitnessLevelBadge').className = 'badge ' + (fitnessLevel === 'beginner' ? 'bg-info' : fitnessLevel === 'intermediate' ? 'bg-warning' : 'bg-danger');

            // ذخیره در localStorage
            localStorage.setItem('fitnessLevel', fitnessLevel);
            localStorage.setItem('fitnessGoal', fitnessGoal);

            alert('اطلاعات ورزشی با موفقیت ذخیره شد');
        }

        // ذخیره اطلاعات سلامتی
        function saveHealthInfo() {
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);

            // محاسبه BMI
            if (height && weight) {
                const bmi = (weight / ((height / 100) * (height / 100))).toFixed(1);
                let bmiStatus = '';
                let bmiClass = '';

                if (bmi < 18.5) {
                    bmiStatus = 'کمبود وزن';
                    bmiClass = 'bg-info';
                } else if (bmi < 25) {
                    bmiStatus = 'طبیعی';
                    bmiClass = 'bg-success';
                } else if (bmi < 30) {
                    bmiStatus = 'اضافه وزن';
                    bmiClass = 'bg-warning';
                } else {
                    bmiStatus = 'چاقی';
                    bmiClass = 'bg-danger';
                }

                document.getElementById('bmiValue').textContent = `${bmi} (${bmiStatus})`;
                document.getElementById('bmiValue').className = `form-control ${bmiClass} text-white`;
            }

            alert('اطلاعات سلامتی با موفقیت ذخیره شد');
        }

        // انتخاب اشتراک
        function selectSubscription(type) {
            const subscriptions = {
                'basic': {
                    name: 'پایه',
                    price: 150000,
                    color: 'bronze'
                },
                'premium': {
                    name: 'پریمیوم',
                    price: 350000,
                    color: 'silver'
                },
                'vip': {
                    name: 'VIP',
                    price: 600000,
                    color: 'gold'
                }
            };

            const sub = subscriptions[type];

            // به‌روزرسانی UI
            document.getElementById('currentSubPrice').textContent = sub.price.toLocaleString() + ' تومان';
            document.getElementById('subscriptionBadge').textContent = sub.name;
            document.getElementById('subscriptionBadge').className = 'badge ms-2 ' + (sub.color === 'gold' ? 'bg-warning' : sub.color === 'silver' ? 'bg-secondary' : 'bg-danger');

            // ذخیره در localStorage
            localStorage.setItem('subscriptionType', type);
            localStorage.setItem('subscriptionName', sub.name);
            localStorage.setItem('subscriptionPrice', sub.price);

            // نمایش مودال پرداخت
            document.getElementById('paymentAmount').value = sub.price;
            const modal = new bootstrap.Modal(document.getElementById('paymentModal'));
            modal.show();

            alert(`اشتراک ${sub.name} انتخاب شد`);
        }

        // نمایش مودال پرداخت
        function showPaymentModal() {
            const modal = new bootstrap.Modal(document.getElementById('paymentModal'));
            modal.show();
        }

        // پردازش پرداخت
        function processPayment() {
            const amount = document.getElementById('paymentAmount').value;
            const gateway = document.getElementById('paymentGateway').value;

            if (!amount || amount < 10000) {
                alert('مبلغ پرداخت معتبر نیست');
                return;
            }

            // شبیه‌سازی پرداخت
            setTimeout(() => {
                // به‌روزرسانی موجودی
                const currentBalance = parseInt(localStorage.getItem('walletBalance') || '150000');
                const newBalance = currentBalance + parseInt(amount);
                localStorage.setItem('walletBalance', newBalance);

                // به‌روزرسانی UI
                document.getElementById('walletBalance').textContent = newBalance.toLocaleString() + ' تومان';

                // بستن مودال
                const modal = bootstrap.Modal.getInstance(document.getElementById('paymentModal'));
                modal.hide();

                alert(`پرداخت ${parseInt(amount).toLocaleString()} تومان با موفقیت انجام شد`);
            }, 2000);
        }

        // نمایش تاریخچه پرداخت
        function showPaymentHistory() {
            alert('تاریخچه پرداخت‌ها:\n\n۱۴۰۲/۱۱/۱۵ - ۳۵۰,۰۰۰ تومان\n۱۴۰۲/۱۰/۱۵ - ۳۵۰,۰۰۰ تومان\n۱۴۰۲/۰۹/۱۵ - ۳۵۰,۰۰۰ تومان\n\nجمع کل: ۱,۰۵۰,۰۰۰ تومان');
        }

        // نمایش جزئیات درآمد مربی
        function showEarningsDetails() {
            alert('جزئیات درآمد ماهانه مربی:\n\n• علی محمدی: ۴,۲۰۰,۰۰۰ تومان\n• فاطمه کریمی: ۳,۸۰۰,۰۰۰ تومان\n• رضا احمدی: ۴,۵۰۰,۰۰۰ تومان\n\nمیانگین درآمد: ۴,۱۶۶,۶۶۷ تومان');
        }

        // ورود به کلاس
        function joinClass(button) {
            const classCard = button.closest('.class-card');
            const className = classCard.querySelector('h5').textContent;

            alert(`در حال ورود به کلاس ${className}...\n\nاین قابلیت در نسخه کامل فعال خواهد شد.`);
        }

        // کنسل کردن کلاس
        function cancelClass(button) {
            if (confirm('آیا از کنسل کردن این کلاس اطمینان دارید؟')) {
                const classCard = button.closest('.class-card');
                classCard.style.opacity = '0.5';
                classCard.querySelector('button').disabled = true;
                alert('کلاس با موفقیت کنسل شد.');
            }
        }

        // ارسال پیام در چت
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            const coachSelect = document.getElementById('selectCoachChat');
            const coachName = coachSelect.options[coachSelect.selectedIndex].text;

            if (!message) return;

            const messagesContainer = document.getElementById('chatMessages');
            const now = new Date();
            const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message sent';
            messageDiv.innerHTML = `
                <strong>شما:</strong>
                <p>${message}</p>
                <small>امروز ${timeString}</small>
            `;

            messagesContainer.appendChild(messageDiv);
            input.value = '';

            // اسکرول به پایین
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // شبیه‌سازی پاسخ مربی
            setTimeout(() => {
                const replyDiv = document.createElement('div');
                replyDiv.className = 'message received';
                replyDiv.innerHTML = `
                    <strong>${coachName}:</strong>
                    <p>پیام شما دریافت شد. به زودی پاسخ می‌دهم.</p>
                    <small>امروز ${timeString}</small>
                `;

                messagesContainer.appendChild(replyDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 1000);
        }

        // بارگذاری تاریخچه چت
        function loadChatHistory() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = `
                <div class="message received">
                    <strong>${document.getElementById('selectCoachChat').options[document.getElementById('selectCoachChat').selectedIndex].text}:</strong>
                    <p>سلام! چطور می‌تونم کمکتون کنم؟</p>
                    <small>امروز ۱۴:۳۰</small>
                </div>
            `;
        }

        // ارسال پیام با Enter
        function handleKeyPress(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        }

        // تغییر رمز عبور
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('لطفاً تمام فیلدها را پر کنید');
                return;
            }

            if (newPassword.length < 8) {
                alert('رمز عبور جدید باید حداقل ۸ کاراکتر باشد');
                return;
            }

            if (!newPassword.match(/^(?=.*[a-zA-Z])(?=.*\d)/)) {
                alert('رمز عبور باید شامل حروف و اعداد باشد');
                return;
            }

            if (newPassword !== confirmPassword) {
                alert('رمز عبور جدید و تکرار آن مطابقت ندارند');
                return;
            }

            alert('رمز عبور با موفقیت تغییر یافت');

            // پاک کردن فیلدها
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
        }

        // خروج از حساب کاربری
        function logout() {
            if (confirm('آیا از حساب کاربری خود خارج می‌شوید؟')) {
                localStorage.removeItem('isLoggedIn');
                window.location.href = 'login.html';
            }
        }

        // مقداردهی اولیه
        document.addEventListener('DOMContentLoaded', function() {
            // بررسی لاگین
            if (checkLoginStatus()) {
                // نمایش بخش اول به طور پیش‌فرض
                showSection('personal');

                // بارگذاری عکس پروفایل
                loadAvatar();

                // مقداردهی اولیه اطلاعات
                const fitnessLevel = localStorage.getItem('fitnessLevel') || 'intermediate';
                document.getElementById('fitnessLevel').value = fitnessLevel;
                saveFitnessInfo(); // برای به‌روزرسانی نشان‌گر

                const walletBalance = localStorage.getItem('walletBalance') || '150000';
                document.getElementById('walletBalance').textContent = parseInt(walletBalance).toLocaleString() + ' تومان';
            }
        });
    </script>
    <!-- چت بات هوشمند -->
    <script src="assets/js/chatbot.js"></script>
</body>

</html>